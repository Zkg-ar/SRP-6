# SRP-6
```
SRP 3(6)a

Факторы протокола:

- хеш функция H 
- N - простое = 2*q+1, где q - простое
- g - генератор по mod N: для любого 0 < X < N существует единственный x такой, что g^x mod N = X
- k - множитель (может быть хеш-функцией), для простоты и производительности примем его за константу = 3

Собственно протокол:

I. Регистрация.

    В процессе регистрации принимает участие два компонента - клиент и сервер.
    На клиенте генерируется:
    - s - случайная строка
    - x = H(S, p)
    - p - password
    - v = g^x mod N
    затем отсылается серверу :
     I - username
     s - соль (случайная строка)
     v - верификатор пароля
     (на сервере не хранится пароль)

II. Аутентификация.

II.I Фаза 1.

    Клиент отправляет на сервер A и I:
    I - username
    генерирует a - случайное число
    A = g^a mod N

    Сервер должен убедиться, что A != 0

    Затем сервер генерирует случайное число b
    и вычисляет B = (k*v + g^b mod N) mod N

    Затем сервер отсылает клиенту s и B

    Клиент проверяет, что B != 0

    Затем обе стороны вычисляют u = H(A, B)

    Если u = 0, то соединение прерывается

    Клиент на основе введённого пароля p вычисляет общий ключ сессии(K):
    x = H(s, p)
    S = ( ( B - k * (g^x mod N) ) ^ (a + u * x) ) mod N
    K = H(S)

    Сервер вычисляет общий ключ сессии:
    S = ( (A * (v^u mod N)) ^ b ) % N
    K = H(S)

    После этого сервер и клиент - оба имеют одинаковые К.

II.II  Фаза 2.

    Генерация подтверждения.
    Клиент: M = H( H(N) xor H(g), H(I), S, A, B, k )
    Сервер: вычисляет М и если оно равно М от клиента, то всё ок и клиенту отсылается R = H (A, M, K)
    Клиент получает R только в том случае, если М вычисленный на сервере равен М от клиента.

    Если вычисленная клиентом R = R c сервера, то клиент и сервер те за кого себя выдают.
```
